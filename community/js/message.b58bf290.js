(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["message"],{"1d11":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"message"},[a("div",{staticClass:"layout"},[a("Header"),a("div",{staticClass:"layout-main"},[a("div",{staticClass:"community-container"},[a("div",{staticClass:"community-main"},[a("div",{staticClass:"card-list"},[a("TabBar",{ref:"tabBar",attrs:{dynamicCount:t.dynamicCount,msgCount:t.msgCount},on:{bindTab:t.bindTab}}),a("div",{staticClass:"infinite-scroll",staticStyle:{"overflow-y":"auto"}},[a("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.onLoad,expression:"onLoad"}],staticClass:"infinite-list",attrs:{"infinite-scroll-disabled":t.disabled,"infinite-scroll-distance":10}},["dynamic"===t.type?t._l(t.dynamicList,(function(e,i){return a("li",{key:i},[a("MsgCard",{attrs:{type:t.type,subType:t.subType,content:e},on:{"update:type":function(e){t.type=e},"update:subType":function(e){t.subType=e},"update:sub-type":function(e){t.subType=e}}})],1)})):t._e(),"msg"===t.type?t._l(t.msgList,(function(e,i){return a("li",{key:i},[a("MsgCard",{attrs:{type:t.type,subType:t.subType,content:e},on:{"update:type":function(e){t.type=e},"update:subType":function(e){t.subType=e},"update:sub-type":function(e){t.subType=e}}})],1)})):t._e()],2),a("p",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]},[t._v("加载中...")]),a("p",{directives:[{name:"show",rawName:"v-show",value:t.disabled,expression:"disabled"}],attrs:{id:"footer"}},[t._v(t._s(t.page===t.last_page?"没有更多了":""))])])],1)])])])],1)])},n=[],s=(a("96cf"),a("1da1")),r=(a("ac6a"),a("7514"),a("b775"));function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/api/feed/messages/followers",method:"get",params:t})}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/api/feed/messages/liked",method:"get",params:t})}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/api/feed/messages/comments",method:"get",params:t})}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/api/feed/messages/ats",method:"get",params:t})}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/api/feed/messages/dynamic",method:"get",params:t})}var p=a("ca00"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"tab-bar"},[a("div",{staticClass:"layout"},[a("div",{staticClass:"menu-box"},[a("el-menu",{ref:"menu",attrs:{"default-active":"1","active-text-color":"#333333"},on:{open:t.handleOpen}},[a("el-menu-item",{attrs:{index:"1"},on:{click:function(e){return t.bindTab("dynamic")}}},[a("i",{staticClass:"iconfont iconxingqiu"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("动态")])]),a("el-submenu",{attrs:{index:"2"},on:{click:function(e){return t.bindTab("msg")}}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-message"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("消息")])]),a("span",{attrs:{slot:"title"},slot:"title"}),a("el-menu-item",{attrs:{index:"2-1"}},[t._v("粉丝")]),a("el-menu-item",{attrs:{index:"2-2"}},[t._v("点赞")]),a("el-menu-item",{attrs:{index:"2-3"}},[t._v("@我的")]),a("el-menu-item",{attrs:{index:"2-4"}},[t._v("评论")])],2)],1)],1)])])},g=[],m=(a("c5f6"),{name:"TabBar",props:{dynamicCount:{type:Number,default:function(){return 0}},msgCount:{type:Number,default:function(){return 0}}},data:function(){return{active:1,msgTypeList:[{className:"#iconxinxi-fensi",name:"粉丝",value:"fans",active:!0},{className:"#iconxinxi-zan",name:"点赞",value:"awesome",active:!1},{className:"#iconxinxi-quan",name:"@我的",value:"appoint",active:!1},{className:"#iconxinxi-pinglun",name:"评论",value:"review",active:!1}]}},methods:{bindTab:function(t){this.active="dynamic"===t?1:2,this.$emit("bindTab",t)},handleOpen:function(t,e){}},mounted:function(){this.$refs.menu&&this.$refs.menu.open("2")}}),h=m,b=(a("e678"),a("2877")),v=Object(b["a"])(h,f,g,!1,null,"7c0bad42",null),y=v.exports,_={data:function(){return{type:"dynamic",msgTypeList:[{className:"#iconxinxi-fensi",name:"粉丝",value:"fans",active:!0},{className:"#iconxinxi-zan",name:"点赞",value:"awesome",active:!1},{className:"#iconxinxi-quan",name:"@我的",value:"appoint",active:!1},{className:"#iconxinxi-pinglun",name:"评论",value:"review",active:!1}],subType:"fans",loading:!1,disabled:!1,isLoading:!1,page:1,per_page:10,last_page:-1,msgCount:0,dynamicCount:0,dynamicList:[],msgList:[]}},mounted:function(){var t=this;this.getData(),"msg"===this.$route.query.type&&(this.type="msg",this.subType=this.$route.query.subType,this.$refs.tabBar.active=2,this.bindSubType(this.msgTypeList.find((function(e){return e.value===t.subType}))))},methods:{getData:function(){var t=this;if("dynamic"===this.type)l({page:this.page,per_page:this.per_page}).then((function(e){200===e.code&&e.data.length>0?(e.data.forEach((function(e){e.user.avatar=p["a"].defaultAvatar(e.user.avatar),e.thumb_pic=p["a"].getFirstImg(e.content),e.thumb_video=p["a"].getFirstVideo(e.content),e.planetBg=t.$state.allPlanet.find((function(t){return t.id===e.planet_id})).avatar})),t.dynamicList=t.dynamicList.concat(e.data),e.last_page===e.current_page?t.disabled=!0:(t.loading=!1,t.page++)):t.disabled=!0}));else switch(this.subType){case"fans":c({page:this.page,per_page:this.per_page}).then((function(e){200===e.code&&e.data.data.length>0?(t.initList(e.data.data),e.last_page===e.current_page?t.disabled=!0:(t.loading=!1,t.page++)):t.disabled=!0}));break;case"awesome":o({page:this.page,per_page:this.per_page}).then((function(e){200===e.code&&e.data.data.length>0?(t.initList(e.data.data),e.last_page===e.current_page?t.disabled=!0:(t.loading=!1,t.page++)):t.disabled=!0}));break;case"appoint":d({page:this.page,per_page:this.per_page}).then((function(e){200===e.code&&e.data.length>0?(t.initList(e.data.data),e.last_page===e.current_page?t.disabled=!0:(t.loading=!1,t.page++)):t.disabled=!0}));break;default:u({page:this.page,per_page:this.per_page}).then((function(e){200===e.code&&e.data.data.length>0?(t.initList(e.data.data),e.last_page===e.current_page?t.disabled=!0:(t.loading=!1,t.page++)):t.disabled=!0}));break}},initList:function(t){t&&t.length>0&&t.forEach((function(t){t.likable&&(t.title=t.likable.title,t.related_id=t.likable_id),t.post&&(t.title=t.post.title,t.related_id=t.post_id),t.user.name=t.user.username,t.user.avatar=p["a"].defaultAvatar(t.user.avatar),t.thumb_pic||(t.thumb_pic=p["a"].getFirstImg(t.content)),t.thumb_video||(t.thumb_video=p["a"].getFirstVideo(t.content))})),this.msgList=this.msgList.concat(t)},bindTab:function(t){this.disabled=!1,this.page=1,this.type=t,this.getData()},bindSubType:function(t){this.disabled=!1,this.page=1,this.msgTypeList.forEach((function(t){t.active=!1})),t.active=!0,this.subType=t.value,this.msgList=[],this.getData()},onLoad:function(t){this.refreshing&&(this.list=[],this.refreshing=!1),this.getData()},onRefresh:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.disabled=!1,this.page=1,this.loading=!0,this.isLoading=!1,t.next=6,this.onLoad();case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},components:{TabBar:y,MsgCard:function(){return a.e("chunk-6d93d226").then(a.bind(null,"830a"))}}},T=_,x=(a("ded6"),Object(b["a"])(T,i,n,!1,null,"655e6804",null));e["default"]=x.exports},2724:function(t,e,a){},7514:function(t,e,a){"use strict";var i=a("5ca1"),n=a("0a49")(5),s="find",r=!0;s in[]&&Array(1)[s]((function(){r=!1})),i(i.P+i.F*r,"Array",{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(s)},"95c6":function(t,e,a){},aa77:function(t,e,a){var i=a("5ca1"),n=a("be13"),s=a("79e5"),r=a("fdef"),c="["+r+"]",o="​",u=RegExp("^"+c+c+"*"),d=RegExp(c+c+"*$"),l=function(t,e,a){var n={},c=s((function(){return!!r[t]()||o[t]()!=o})),u=n[t]=c?e(p):r[t];a&&(n[a]=u),i(i.P+i.F*c,"String",n)},p=l.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(d,"")),t};t.exports=l},c5f6:function(t,e,a){"use strict";var i=a("7726"),n=a("69a8"),s=a("2d95"),r=a("5dbc"),c=a("6a99"),o=a("79e5"),u=a("9093").f,d=a("11e9").f,l=a("86cc").f,p=a("aa77").trim,f="Number",g=i[f],m=g,h=g.prototype,b=s(a("2aeb")(h))==f,v="trim"in String.prototype,y=function(t){var e=c(t,!1);if("string"==typeof e&&e.length>2){e=v?e.trim():p(e,3);var a,i,n,s=e.charCodeAt(0);if(43===s||45===s){if(a=e.charCodeAt(2),88===a||120===a)return NaN}else if(48===s){switch(e.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+e}for(var r,o=e.slice(2),u=0,d=o.length;u<d;u++)if(r=o.charCodeAt(u),r<48||r>n)return NaN;return parseInt(o,i)}}return+e};if(!g(" 0o1")||!g("0b1")||g("+0x1")){g=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof g&&(b?o((function(){h.valueOf.call(a)})):s(a)!=f)?r(new m(y(e)),a,g):y(e)};for(var _,T=a("9e1e")?u(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;T.length>x;x++)n(m,_=T[x])&&!n(g,_)&&l(g,_,d(m,_));g.prototype=h,h.constructor=g,a("2aba")(i,f,g)}},ded6:function(t,e,a){"use strict";var i=a("95c6"),n=a.n(i);n.a},e678:function(t,e,a){"use strict";var i=a("2724"),n=a.n(i);n.a},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);