(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["message"],{"1d11":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"message"},[a("div",{staticClass:"layout"},[a("Header",{on:{getSerch:t.getSerch}}),a("div",{staticClass:"layout-main"},[a("div",{staticClass:"community-container"},[a("div",{staticClass:"community-main"},[a("div",{staticClass:"card-list"},[a("TabBar",{ref:"tabBar",attrs:{dynamicCount:t.dynamicCount,msgCount:t.msgCount},on:{bindTab:t.bindTab}}),a("div",{staticClass:"infinite-scroll",staticStyle:{"overflow-y":"auto"}},[a("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.onLoad,expression:"onLoad"}],staticClass:"infinite-list",attrs:{"infinite-scroll-disabled":t.disabled,"infinite-scroll-distance":10}},["dynamic"===t.type?t._l(t.dynamicList,(function(e,i){return a("li",{key:i},[a("MsgCard",{attrs:{type:t.type,subType:t.subType,content:e},on:{"update:type":function(e){t.type=e},"update:subType":function(e){t.subType=e},"update:sub-type":function(e){t.subType=e}}})],1)})):t._e(),"msg"===t.type?t._l(t.msgList,(function(e,i){return a("li",{key:i},[a("MsgCard",{attrs:{type:t.type,subType:t.subType,content:e},on:{"update:type":function(e){t.type=e},"update:subType":function(e){t.subType=e},"update:sub-type":function(e){t.subType=e}}})],1)})):t._e()],2),a("p",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]},[t._v("加载中...")]),a("p",{directives:[{name:"show",rawName:"v-show",value:t.finished,expression:"finished"}],attrs:{id:"footer"}},[t._v(t._s(t.page===t.last_page?"没有更多了":""))])])],1)])])])],1)])},n=[],s=(a("96cf"),a("1da1")),r=(a("ac6a"),a("7514"),a("b775"));function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/api/feed/messages/followers",method:"get",params:t})}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/api/feed/messages/liked",method:"get",params:t})}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/api/feed/messages/comments",method:"get",params:t})}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/api/feed/messages/ats",method:"get",params:t})}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/api/feed/messages/dynamic",method:"get",params:t})}var f=a("ca00"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"tab-bar"},[a("div",{staticClass:"tab-box"},[a("div",{class:["tab",{active:1===t.active}],on:{click:function(e){return t.bindTab("dynamic")}}},[t._v("动态\n      "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.dynamicCount>0,expression:"dynamicCount>0"}],staticClass:"badge"},[t._v(t._s(t.dynamicCount))])]),a("div",{class:["tab",{active:2===t.active}],on:{click:function(e){return t.bindTab("msg")}}},[t._v("消息\n      "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.msgCount>0,expression:"msgCount>0"}],staticClass:"badge"},[t._v(t._s(t.msgCount))])])])])},g=[],h=(a("c5f6"),{name:"TabBar",props:{dynamicCount:{type:Number,default:function(){return 0}},msgCount:{type:Number,default:function(){return 0}}},data:function(){return{active:1}},methods:{bindTab:function(t){this.active="dynamic"===t?1:2,this.$emit("bindTab",t)}}}),m=h,v=(a("6d4d"),a("2877")),b=Object(v["a"])(m,l,g,!1,null,"b467109a",null),y=b.exports,_={data:function(){return{type:"dynamic",msgTypeList:[{className:"#iconxinxi-fensi",name:"粉丝",value:"fans",active:!0},{className:"#iconxinxi-zan",name:"点赞",value:"awesome",active:!1},{className:"#iconxinxi-quan",name:"@我的",value:"appoint",active:!1},{className:"#iconxinxi-pinglun",name:"评论",value:"review",active:!1}],subType:"fans",loading:!1,finished:!1,isLoading:!1,page:1,per_page:10,msgCount:0,dynamicCount:0,dynamicList:[],msgList:[]}},mounted:function(){var t=this;this.getData(),"msg"===this.$route.query.type&&(this.type="msg",this.subType=this.$route.query.subType,this.$refs.tabBar.active=2,this.bindSubType(this.msgTypeList.find((function(e){return e.value===t.subType}))))},methods:{getData:function(){var t=this;if("dynamic"===this.type)p({page:this.page,per_page:this.per_page}).then((function(e){200===e.code&&e.data.length>0?(e.data.forEach((function(t){t.user.avatar=f["a"].defaultAvatar(t.user.avatar),t.thumb_pic=f["a"].getFirstImg(t.content),t.thumb_video=f["a"].getFirstVideo(t.content)})),t.dynamicList=t.dynamicList.concat(e.data),e.last_page===e.current_page?t.finished=!0:(t.loading=!1,t.page++)):t.finished=!0}));else switch(this.subType){case"fans":c({page:this.page,per_page:this.per_page}).then((function(e){200===e.code&&e.data.data.length>0?(t.initList(e.data.data),e.last_page===e.current_page?t.finished=!0:(t.loading=!1,t.page++)):t.finished=!0}));break;case"awesome":o({page:this.page,per_page:this.per_page}).then((function(e){200===e.code&&e.data.data.length>0?(t.initList(e.data.data),e.last_page===e.current_page?t.finished=!0:(t.loading=!1,t.page++)):t.finished=!0}));break;case"appoint":d({page:this.page,per_page:this.per_page}).then((function(e){200===e.code&&e.data.length>0?(t.initList(e.data.data),e.last_page===e.current_page?t.finished=!0:(t.loading=!1,t.page++)):t.finished=!0}));break;default:u({page:this.page,per_page:this.per_page}).then((function(e){200===e.code&&e.data.data.length>0?(t.initList(e.data.data),e.last_page===e.current_page?t.finished=!0:(t.loading=!1,t.page++)):t.finished=!0}));break}},initList:function(t){t&&t.length>0&&t.forEach((function(t){t.likable&&(t.title=t.likable.title,t.related_id=t.likable_id),t.post&&(t.title=t.post.title,t.related_id=t.post_id),t.user.name=t.user.username,t.user.avatar=f["a"].defaultAvatar(t.user.avatar),t.thumb_pic||(t.thumb_pic=f["a"].getFirstImg(t.content)),t.thumb_video||(t.thumb_video=f["a"].getFirstVideo(t.content))})),this.msgList=this.msgList.concat(t)},bindTab:function(t){this.finished=!1,this.page=1,this.type=t,this.getData()},bindSubType:function(t){this.finished=!1,this.page=1,this.msgTypeList.forEach((function(t){t.active=!1})),t.active=!0,this.subType=t.value,this.msgList=[],this.getData()},onLoad:function(t){this.refreshing&&(this.list=[],this.refreshing=!1),this.getData()},onRefresh:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.finished=!1,this.page=1,this.loading=!0,this.isLoading=!1,t.next=6,this.onLoad();case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},components:{TabBar:y,MsgCard:function(){return a.e("chunk-6d93d226").then(a.bind(null,"830a"))}}},T=_,C=(a("932d"),Object(v["a"])(T,i,n,!1,null,"387d04a1",null));e["default"]=C.exports},"6d4d":function(t,e,a){"use strict";var i=a("c0d3"),n=a.n(i);n.a},7514:function(t,e,a){"use strict";var i=a("5ca1"),n=a("0a49")(5),s="find",r=!0;s in[]&&Array(1)[s]((function(){r=!1})),i(i.P+i.F*r,"Array",{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(s)},"932d":function(t,e,a){"use strict";var i=a("d752"),n=a.n(i);n.a},aa77:function(t,e,a){var i=a("5ca1"),n=a("be13"),s=a("79e5"),r=a("fdef"),c="["+r+"]",o="​",u=RegExp("^"+c+c+"*"),d=RegExp(c+c+"*$"),p=function(t,e,a){var n={},c=s((function(){return!!r[t]()||o[t]()!=o})),u=n[t]=c?e(f):r[t];a&&(n[a]=u),i(i.P+i.F*c,"String",n)},f=p.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(d,"")),t};t.exports=p},c0d3:function(t,e,a){},c5f6:function(t,e,a){"use strict";var i=a("7726"),n=a("69a8"),s=a("2d95"),r=a("5dbc"),c=a("6a99"),o=a("79e5"),u=a("9093").f,d=a("11e9").f,p=a("86cc").f,f=a("aa77").trim,l="Number",g=i[l],h=g,m=g.prototype,v=s(a("2aeb")(m))==l,b="trim"in String.prototype,y=function(t){var e=c(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():f(e,3);var a,i,n,s=e.charCodeAt(0);if(43===s||45===s){if(a=e.charCodeAt(2),88===a||120===a)return NaN}else if(48===s){switch(e.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+e}for(var r,o=e.slice(2),u=0,d=o.length;u<d;u++)if(r=o.charCodeAt(u),r<48||r>n)return NaN;return parseInt(o,i)}}return+e};if(!g(" 0o1")||!g("0b1")||g("+0x1")){g=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof g&&(v?o((function(){m.valueOf.call(a)})):s(a)!=l)?r(new h(y(e)),a,g):y(e)};for(var _,T=a("9e1e")?u(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),C=0;T.length>C;C++)n(h,_=T[C])&&!n(g,_)&&p(g,_,d(h,_));g.prototype=m,m.constructor=g,a("2aba")(i,l,g)}},d752:function(t,e,a){},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);