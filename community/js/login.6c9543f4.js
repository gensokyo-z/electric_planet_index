(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{"28a2":function(e,t,o){},"9ed6":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",{staticClass:"login"},[o("div",{staticClass:"logo",on:{click:function(t){return e.$router.push("/")}}}),o("div",{staticClass:"form"},[o("div",{staticClass:"form-item"},[o("i",{staticClass:"iconfont icondenglu-dianhua"}),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.phone,expression:"form.phone",modifiers:{trim:!0}}],attrs:{type:"tel",maxlength:"11",placeholder:"请输入手机号码"},domProps:{value:e.form.phone},on:{input:function(t){t.target.composing||e.$set(e.form,"phone",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),o("div",{staticClass:"form-item"},[o("i",{staticClass:"iconfont icondenglu-mima"}),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.code,expression:"form.code",modifiers:{trim:!0}}],attrs:{type:"tel",oninput:"if(value.length>6)value=value.slice(0,6)",placeholder:"请输入短信验证码"},domProps:{value:e.form.code},on:{input:function(t){t.target.composing||e.$set(e.form,"code",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),o("span",{staticClass:"down-code",on:{click:e.sendCode}},[e._v(e._s(60===e.second?"输入验证码":"重新发送"+e.second+"s"))])]),o("div",{staticClass:"login-btn",on:{click:e.handleLogin}},[e._v("登 录 / 注 册")]),o("div",{staticClass:"tips"},[e._v("未注册用户登陆默认为新注册用户")])])])},i=[],s=(o("a481"),o("b6df")),c=o("ca00"),a=null,r={name:"login",data:function(){return{showFrom:!1,mobileReg:/^1\d{10}$/,second:60,form:{phone:"",code:""},appId:"",redirect:""}},created:function(){var e=this;this.$route.query.code&&"wxlogin"===this.$route.query.state&&Object(s["e"])({code:this.$route.query.code}).then((function(t){200===t.code&&(c["a"].setcookie("TOKEN",t.data.access_token),e.$store.commit("setToken",t.data.access_token),e.$router.replace("/index"))}))},methods:{sendCode:function(){var e=this;if(60===this.second){if(!this.mobileReg.test(this.form.phone))return this.$message("请输入正确的手机号码"),!1;var t={phone:this.form.phone};Object(s["d"])(t).then((function(t){200===t.code?(e.$message("验证码已经发送到您的手机"),e.calcTime()):e.$message(t.msg)})).catch((function(e){console.log(e)}))}},validcode:function(){if(!this.mobileReg.test(this.form.phone))return this.$message("请输入正确的手机号码"),!1;if(this.isPhone){if(!this.form.code)return this.$message("请输入短信验证码"),!1;if(this.form.code.length<6)return this.$message("请输入6位短信验证码"),!1}return!0},wxLogin:function(){var e=this;Object(s["a"])().then((function(t){200===t.code&&(e.appId=t.data.app_id,location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx9e3256b652743b0a&redirect_uri=https%3A%2F%2Fddxq.tech%2Fh5%2Flogin&response_type=code&scope=snsapi_userinfo&state=wxlogin#wechat_redirect")}))},handleLogin:function(){var e=this;if(this.validcode()){var t={phone:this.form.phone,captcha:this.form.code};Object(s["b"])(t).then((function(t){200===t.code?(c["a"].setcookie("TOKEN",t.data.access_token),e.$store.commit("setToken",t.data.access_token),e.redirect?location.href=decodeURIComponent(e.redirect):e.$router.replace("/index")):e.$message(t.msg)})).catch((function(t){e.$message(t.msg)}))}},calcTime:function(){var e=this;a&&clearInterval(a),a=setInterval((function(){e.second--||(clearInterval(a),a=null,e.second=60)}),1e3)}},beforeDestroy:function(){a&&clearInterval(a)}},d=r,l=(o("c84b"),o("2877")),u=Object(l["a"])(d,n,i,!1,null,"1eeca26d",null);t["default"]=u.exports},c84b:function(e,t,o){"use strict";var n=o("28a2"),i=o.n(n);i.a}}]);