(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["postdetail"],{ad8f:function(t,s,e){"use strict";var a=e("b951"),n=e.n(a);n.a},b951:function(t,s,e){},d3da:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("section",{staticClass:"index-detail"},[e("div",{staticClass:"layout"},[e("Header"),e("div",{staticClass:"layout-main"},[e("div",{staticClass:"tweet-container"},[e("div",{staticClass:"tweet-main"},[e("article",{staticClass:"tweet-article"},[e("h1",{staticClass:"article-title"},[t._v(t._s(t.content.title))]),e("div",{staticClass:"article-info"},[e("div",{directives:[{name:"show",rawName:"v-show",value:"user"===t.content.source,expression:"content.source === 'user'"}],staticClass:"article-avatar"},[e("img",{attrs:{src:t.content.user.avatar}})]),e("div",{directives:[{name:"show",rawName:"v-show",value:"user"===t.content.source,expression:"content.source === 'user'"}],staticClass:"article-author"},[t._v(" "+t._s(t.content.user.username)+"· ")]),e("div",{staticClass:"article-date"},[t._v(t._s(t.content.create_time))]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.content.url,expression:"content.url"}],staticClass:"article-date"},[e("a",{attrs:{href:t.content.url,target:"_blank"}},[t._v("查看原文")])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:"user"!==t.content.source,expression:"content.source !== 'user'"}],staticClass:"article-planet"},[t._v(" "+t._s(t.content.planet.name)+"\n              "),t._l(t.content.tags,(function(s,a){return e("a",{key:a},[t._v("#"+t._s(s.name))])}))],2),e("div",{staticClass:"article-content",domProps:{innerHTML:t._s(t.content.content)}}),e("section",{directives:[{name:"show",rawName:"v-show",value:t.commentList,expression:"commentList"}],ref:"commentsSection",staticClass:"comments-section",attrs:{id:"comments-section"}},[e("h2",{staticClass:"section-title"},[t._v("全部评论")]),e("div",{staticClass:"comment-container"},[e("ul",{staticClass:"comments-list"},t._l(t.commentList,(function(s,a){return e("li",{key:a,staticClass:"comment-item"},[e("div",{staticClass:"author-avatar"},[e("img",{attrs:{src:s.user.avatar}})]),e("div",{staticClass:"comment-main"},[e("div",{staticClass:"comment-header"},[e("span",{staticClass:"author-name"},[t._v(t._s(s.user.username))]),t._v(" ·\n                        "),e("span",{staticClass:"comment-time"},[t._v(t._s(s.created_at))])]),e("div",{staticClass:"comment-content"},[t._v("\n                        "+t._s(s.content)+"\n                      ")]),e("div",{staticClass:"comment-footer"},[e("div",{staticClass:"footer-button",on:{click:function(e){t.checkAuth(t.bindApproval(s))}}},[e("div",{staticClass:"like-simple"},[e("i",{staticClass:"iconfont iconzan"}),e("span",{staticClass:"data-number"},[t._v(t._s(s.user_liked_count>0?s.user_liked_count:"点赞"))])])]),e("div",{staticClass:"footer-button",on:{click:function(e){t.checkAuth(t.handlerInputDialog(s))}}},[e("i",{staticClass:"iconfont iconpinglun"}),e("span",{staticClass:"data-number"},[t._v(t._s(s.second_comments_count>0?s.second_comments_count:"回复"))])])]),e("ul",{staticClass:"reply-container"},t._l(s.second_comments,(function(s,a){return e("li",{key:a,staticClass:"comment-item"},[e("div",{staticClass:"author-avatar"},[e("img",{attrs:{src:s.user.avatar}})]),e("div",{staticClass:"comment-main"},[e("div",{staticClass:"comment-header"},[e("span",{staticClass:"author-name"},[t._v(t._s(s.user.username))]),t._v(" ·\n                              "),e("span",{staticClass:"comment-time"},[t._v(t._s(s.created_at))])]),e("div",{staticClass:"comment-content"},[t._v("\n                              "+t._s(s.content)+"\n                            ")]),e("div",{staticClass:"comment-footer"},[e("div",{staticClass:"footer-button",on:{click:function(e){t.checkAuth(t.bindApproval(s))}}},[t._m(0,!0)]),e("div",{staticClass:"footer-button",on:{click:function(e){t.checkAuth(t.handlerInputDialog(s))}}},[e("i",{staticClass:"iconfont iconpinglun"}),e("span",{staticClass:"data-number"},[t._v("回复")])])]),t._m(1,!0)])])})),0)])])})),0)])])]),e("Footer",{attrs:{content:t.content}})],1)])])],1),e("el-dialog",{attrs:{title:"发表评论",top:"30vh",width:"630px",visible:t.showInput,"custom-class":"input-item","append-to-body":""},on:{"update:visible":function(s){t.showInput=s}}},[e("div",{staticClass:"comment-editor"},[e("div",{staticClass:"editor"},[e("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入评论内容",maxlength:"140","show-word-limit":""},model:{value:t.message,callback:function(s){t.message=s},expression:"message"}})],1),e("div",{staticClass:"editor-function"},[e("el-button",{class:{empty:0===t.message.length},attrs:{disabled:0===t.message.length},on:{click:t.sendMessage}},[t._v("回复")])],1)])])],1)},n=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"like-simple"},[e("i",{staticClass:"iconfont iconzan"}),e("span",{staticClass:"data-number"},[t._v("点赞")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",{staticClass:"reply-container"},[e("li")])}],i=(e("ac6a"),e("9c3c")),c=e("ca00"),o={data:function(){return{flash:!0,loading:!0,id:this.$route.query.id||"",hiddenMeun:!0,content:{planet:{},tags:[],user:{}},commentList:null,showInput:!1,comment:{},message:""}},mounted:function(){var t=this;this.$bus.$on("snedComment",(function(){t.getDetail(!0)})),this.getDetail(!1)},methods:{checkAuth:function(t){this.$store.dispatch("needAuth",t)},conutDown:function(){var t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:700;setTimeout((function(){t.flash=!1,t.loading=!1}),s)},getDetail:function(t){var s=this;if(t){var e=this.$refs.commentsSection;e&&setTimeout((function(){e.scrollIntoView(!0)}),100)}Object(i["g"])(this.id).then((function(t){if(200===t.code){var e=700;"user"===t.data.source?t.data.user.avatar=c["a"].defaultAvatar(t.data.user.avatar):"微博"===t.data.source&&(e=1e3,t.data.weiboAvatar=c["a"].defaultAvatar("")),t.data.thumb_pic=c["a"].getFirstImg(t.data.content),s.content=t.data,s.content.url?s.conutDown(e):(s.flash=!1,s.loading=!1),Object(i["f"])({id:s.id,page:1}).then((function(t){200===t.code&&(t.data.forEach((function(t){t.comments_count=t.second_comments_count,t.user.avatar=c["a"].defaultAvatar(t.user.avatar),t.second_comments.forEach((function(t){t.user.avatar=c["a"].defaultAvatar(t.user.avatar)}))})),s.commentList=t.data)}))}}))},bindApproval:function(t){var s=this;t.has_liked?Object(i["d"])(t.id).then((function(t){200===t.code&&s.$message("取消评论点赞成功！")})):Object(i["c"])(t.id).then((function(t){200===t.code&&(s.$message.success("点赞评论成功！"),s.userLikedCount++)}))},handlerInputDialog:function(t){this.comment=t,this.showInput=!0},sendMessage:function(){var t=this,s=this.message;if(s.length>140)return this.$message("请限制评论在140个字以内");Object(i["b"])({content:s,id:this.comment.id}).then((function(s){200===s.code?(t.message="",t.showInput=!1,t.$bus.$emit("snedComment"),t.$message.success("评论成功！")):t.$message(s.msg)}))},goBack:function(){this.$router.back()},addPlanet:function(){this.$dialog.confirm({title:"提示",message:"是否加入该星球"}).then((function(){})).catch((function(){}))},sendComment:function(){}},computed:{btnName:function(){return"加入"}}},r=o,l=(e("ad8f"),e("2877")),u=Object(l["a"])(r,a,n,!1,null,"0c1693bf",null);s["default"]=u.exports}}]);